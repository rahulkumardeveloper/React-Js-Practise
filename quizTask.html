<script src="react.development.js"></script>
<script src="babel.min.js"></script>
<script src="react-dom.development.js"></script>
<style>
  .timer {
    position: fixed;
    top: 0;
    right: 0px;
    font-size: 30px;
    line-height: 7px;
    color: red;
  }
</style>

<div id="root"></div>

<script type="text/babel">
  const App = () => {
    const questionData = [
      {
        id: 1,
        quesName: "Can we changes the props values in child componenent?.",
        options: ["Yes", "No"],
        type: "S",
      },
      {
        id: 2,
        quesName: "How to pass data from child to parent component.?",
        options: ["Callback", "props", "state", "none"],
        type: "S",
      },
      {
        id: 3,
        quesName: "How many way to pass data between component.?",
        options: ["Callback", "props", "children", "none"],
        type: "M",
      },
    ];

    const answerOption = ["A", "B", "C", "D"];
    const answer = {};
    const correctAnswer = { 1: "B", 2: "A", 3: "ABC" };
    var countMark = 0;
    var intervalId;
    const [isSubmit, setSubmit] = React.useState(false);
    const [isTimer, setTimer] = React.useState(10);

    React.useEffect(()=>{
      intervalId = setInterval(()=>{
        setTimer(prevTimer => {          
          let newTimer= prevTimer - 1
          if(newTimer==0){
            console.log("component did mount",answer);
            onSubmit();
          }
          return newTimer;
        });

     },1000);
     return () => clearInterval(intervalId);
    },[]);


    const onSubmit = () => {
      Object.keys(answer).forEach((value, index) => {
        if (answer[value] === correctAnswer[value]) {
          countMark=countMark+1;
        }
      });
      setSubmit({
        isSubmit: true,
      });
      console.log("onsubmit",answer);
      alert(`You Got the marks: ${countMark}`);
    };

    const onRadioChanges = (event) => {
      const { name, value, type, checked } = event.target;

      if (type === "checkbox") {
        let optionStr = answer[name];
        let optionArray = optionStr ? optionStr.split("") : [];

        if (checked) {
          // Add the value to the array if it isn't already there
          if (!optionArray.includes(value)) {
            optionArray.push(value);
          }
        } else {
          // Remove the value from the array if it's unchecked
          countMark = 0;
          optionArray = optionArray.filter((item) => item !== value);
        }

        answer[name] = optionArray.sort().join(""); // Convert array back to string if needed
        console.log("checked",answer);
      } else {
        answer[name] = value;
        console.log("radioButton",answer);
      }
    };

    return (
      <div>
        <h1>Quiz Application</h1>
        <h2 className="timer">{isTimer}</h2>
        <hr />
        {questionData.map((obj, index) => {
          let { id, quesName, options, type } = obj;
          return (
            <div>
              <h3>
                {id}.{quesName}
              </h3>
              {options.map((option, index) => {
                return (
                  <p>
                    {type == "S" && (
                      <input
                        disabled={isSubmit}
                        type="radio"
                        name={id}
                        onChange={onRadioChanges}
                        value={answerOption[index]}
                      ></input>
                    )}
                    {type == "M" && (
                      <input
                        disabled={isSubmit}
                        type="checkbox"
                        name={id}
                        onChange={onRadioChanges}
                        value={answerOption[index]}
                      ></input>
                    )}
                    {option}
                  </p>
                );
              })}
            </div>
          );
        })}

        {!isSubmit && (
          <button type="button" onClick={onSubmit}>
            Submit
          </button>
        )}
      </div>
    );
  };

  const container = ReactDOM.createRoot(document.getElementById("root"));

  container.render(<App />);
</script>
